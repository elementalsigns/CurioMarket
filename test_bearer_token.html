<!DOCTYPE html>
<html>
<head>
    <title>Test Bearer Token Setup</title>
</head>
<body>
    <h1>Development Bearer Token Test</h1>
    <button onclick="setupBearerToken()">Add Bearer Token (Simulates Production)</button>
    <button onclick="clearToken()">Clear Token</button>
    <button onclick="checkCart()">Check Cart API</button>
    <button onclick="testCheckout()">Test Checkout</button>
    
    <div id="status"></div>
    
    <script>
        function log(msg) {
            document.getElementById('status').innerHTML += '<br>' + msg;
            console.log(msg);
        }
        
        function setupBearerToken() {
            // Simulate production Bearer token for user 46848882
            const testToken = 'dev_test_token_46848882';
            localStorage.setItem('curio_auth_token', testToken);
            log('‚úÖ Bearer token set: ' + testToken);
            log('Now cart requests will use Bearer auth (like production)');
        }
        
        function clearToken() {
            localStorage.removeItem('curio_auth_token');
            localStorage.removeItem('replit_access_token');
            log('üóëÔ∏è Tokens cleared - back to session cookies');
        }
        
        async function checkCart() {
            try {
                const response = await fetch('/api/cart', {
                    credentials: 'include',
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('curio_auth_token') || 'none'}`
                    }
                });
                const data = await response.json();
                log(`üì¶ Cart response: ${JSON.stringify(data)}`);
            } catch (err) {
                log(`‚ùå Cart error: ${err.message}`);
            }
        }
        
        async function testCheckout() {
            try {
                const response = await fetch('/api/checkout', {
                    method: 'POST',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${localStorage.getItem('curio_auth_token') || 'none'}`
                    },
                    body: JSON.stringify({})
                });
                const data = await response.json();
                log(`üõí Checkout response: ${JSON.stringify(data)}`);
            } catch (err) {
                log(`‚ùå Checkout error: ${err.message}`);
            }
        }
    </script>
</body>
</html>